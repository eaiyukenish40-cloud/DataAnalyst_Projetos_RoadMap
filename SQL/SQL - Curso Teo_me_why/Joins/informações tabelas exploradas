-- Tabela transacao_produto: idTransacaoProduto	IdTransacao	IdProduto	QtdeProduto	vlProduto

-- Tabela transacoes: IdTransacao	IdCliente	DtCriacao	QtdePontos	DescSistemaOrigem

-- Tabela clientes: idCliente	flEmail	flTwitch	flYouTube	flBlueSky	flInstagram	qtdePontos	DtCriacao	DtAtualizacao

-- Tabela produtos: IdProduto	DescNomeProduto	DescDescricaoProduto	DescCategoriaProduto

-- Qual mes tivemos mais lista de presen√ßa assinada

SELECT
COUNT(t.IdTransacao) AS qtdeTransacao,
substr(DISTINCT t.DtCriacao,1,7) AS meses

FROM transacao_produto tp
LEFT JOIN transacoes t ON tp.IdTransacao = t.IdTransacao
JOIN produtos p ON p.IdProduto = tp.IdProduto
GROUP BY p.DescNomeProduto, meses
ORDER BY qtdeTransacao DESC


